# Оптимизация градиентов - Устранение перерисовок React компонентов

## Проблема
Таймер в `src/pages/Dashboard.tsx` каждые 60 секунд вызывал `setData(prev => ({ ...prev }))`, что заставляло полностью перерисовывать огромный компонент ради обновления плавных градиентов. На мобильных устройствах это вызывало лишние расчёты стилей и раскладку, что приводило к нагреву устройства.

## Решение

### 1. Создана утилита для управления градиентами (`src/lib/gradientUtils.ts`)
- `calculateGradientProgress()` - расчет прогресса градиента на основе времени
- `getGradientColors()` - получение цветов градиента на основе прогресса  
- `updateGradientCSS()` - обновление CSS переменных без перерисовки React
- `getStatusMessage()` - получение текстовых сообщений на основе прогресса
- `initGradientTimer()` - инициализация таймера обновления градиентов

### 2. Обновлен CSS (`src/index.css`)
- Добавлены CSS переменные для каждого типа градиента:
  - `--gradient-feeding-progress`
  - `--gradient-feeding-color-start/end`
  - `--gradient-diaper-progress`
  - `--gradient-diaper-color-start/end`
  - `--gradient-bath-progress`
  - `--gradient-bath-color-start/end`
- Созданы CSS классы для динамических градиентов:
  - `.gradient-feeding-progress`
  - `.gradient-diaper-progress`
  - `.gradient-bath-progress`
  - `.progress-bar-animated`

### 3. Оптимизирован Dashboard.tsx
- Удален проблемный таймер `setData({ ...prevData })`
- Удалена функция `getGradientColor()`
- Добавлен новый `useEffect` с `initGradientTimer()`
- Заменены все вызовы `getGradientColor()` на `getStatusMessage()`
- Обновлены прогресс-бары для использования CSS классов

## Результат

### Производительность
- ✅ Устранены ненужные перерисовки React компонентов каждую минуту
- ✅ Градиенты теперь обновляются через CSS переменные без затрат на Virtual DOM
- ✅ Снижена нагрузка на мобильные устройства
- ✅ Улучшена плавность анимаций

### Функциональность
- ✅ Сохранена вся логика градиентов (зеленый → желтый → красный)
- ✅ Сохранены текстовые сообщения статуса
- ✅ Сохранена плавность переходов цветов
- ✅ Таймер обновления остался тем же (60 секунд)

### Архитектура
- ✅ Разделение ответственности: логика градиентов вынесена в отдельную утилиту
- ✅ Использование CSS переменных для динамических стилей
- ✅ Чистый код без дублирования логики

## Технические детали

### Как это работает
1. `initGradientTimer()` создает таймер, который каждую минуту обновляет CSS переменные
2. CSS переменные автоматически применяются к элементам с соответствующими классами
3. React компоненты не перерисовываются, так как CSS переменные обновляются напрямую через DOM API
4. Плавные переходы обеспечиваются CSS `transition`

### Совместимость
- ✅ Работает во всех современных браузерах
- ✅ Поддерживает CSS переменные (CSS Custom Properties)
- ✅ Обратная совместимость с существующим кодом

## Мониторинг
Для проверки работы оптимизации можно:
1. Открыть DevTools → Performance
2. Записать профиль на 2-3 минуты
3. Убедиться, что нет лишних перерисовок компонентов каждую минуту
4. Проверить, что градиенты плавно меняются без скачков производительности
