# ðŸ”§ Ð˜Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ Ð¿Ð¾ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾ ÑÐ½Ð°

## Ð¨Ð°Ð³ 1: Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ SQL ÑÐºÑ€Ð¸Ð¿Ñ‚
Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ ÑÑ‚Ð¾Ñ‚ ÐºÐ¾Ð´ Ð² Supabase SQL Editor:

```sql
-- Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¿Ð¾Ð»Ðµ video_played Ð² Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ sleep_sessions
ALTER TABLE sleep_sessions 
ADD COLUMN IF NOT EXISTS video_played BOOLEAN DEFAULT FALSE;

-- ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Ð·Ð°Ð¿Ð¸ÑÐ¸
UPDATE sleep_sessions 
SET video_played = FALSE 
WHERE video_played IS NULL;
```

## Ð¨Ð°Ð³ 2: ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð°
ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ DevTools (F12) Ð¸ Ð¿ÐµÑ€ÐµÐ¹Ð´Ð¸Ñ‚Ðµ Ð½Ð° Ð²ÐºÐ»Ð°Ð´ÐºÑƒ Console. Ð’Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ:
- `ðŸŒ™ Video played state from DB: false` - Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹
- `ðŸŒ™ Video started playing, marking as played` - Ð¿Ñ€Ð¸ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ð¸ Ð²Ð¸Ð´ÐµÐ¾

## Ð¨Ð°Ð³ 3: Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
1. **Ð’ÐºÐ»ÑŽÑ‡Ð¸Ñ‚Ðµ Ñ€ÐµÐ¶Ð¸Ð¼ ÑÐ½Ð°** - Ð²Ð¸Ð´ÐµÐ¾ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÑÑ‚Ð¸ÑÑŒ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð·
2. **ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ** - Ð²Ð¸Ð´ÐµÐ¾ ÐÐ• Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÑŒÑÑ ÑÐ½Ð¾Ð²Ð°
3. **ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð¸Ñ‚Ðµ Ð²ÐºÐ»Ð°Ð´ÐºÑƒ Ð¸ Ð²ÐµÑ€Ð½Ð¸Ñ‚ÐµÑÑŒ** - Ð²Ð¸Ð´ÐµÐ¾ ÐÐ• Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÑŒÑÑ ÑÐ½Ð¾Ð²Ð°
4. **Ð’Ñ‹ÐºÐ»ÑŽÑ‡Ð¸Ñ‚Ðµ Ñ€ÐµÐ¶Ð¸Ð¼ ÑÐ½Ð° Ð¸ Ð²ÐºÐ»ÑŽÑ‡Ð¸Ñ‚Ðµ ÑÐ½Ð¾Ð²Ð°** - Ð²Ð¸Ð´ÐµÐ¾ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÑÑ‚Ð¸ÑÑŒ Ð·Ð°Ð½Ð¾Ð²Ð¾

## Ð¨Ð°Ð³ 4: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð² Ð±Ð°Ð·Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ…
Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð² Supabase SQL Editor:
```sql
SELECT id, family_id, start_time, end_time, video_played 
FROM sleep_sessions 
WHERE family_id = YOUR_FAMILY_ID 
ORDER BY start_time DESC 
LIMIT 5;
```

ÐŸÐ¾Ð»Ðµ `video_played` Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ `true` Ð´Ð»Ñ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… ÑÐµÑÑÐ¸Ð¹ ÑÐ½Ð° Ð¿Ð¾ÑÐ»Ðµ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾.

## ðŸ› Ð•ÑÐ»Ð¸ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚

### ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸:
- Ð•ÑÐ»Ð¸ Ð²Ð¸Ð´Ð¸Ñ‚Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ñ `video_played`, Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ SQL ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð½Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½
- Ð•ÑÐ»Ð¸ Ð²Ð¸Ð´Ð¸Ñ‚Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ñ `getSleepVideoPlayedState`, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ðº Ð‘Ð”

### ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹:
```sql
SELECT column_name, data_type, is_nullable, column_default 
FROM information_schema.columns 
WHERE table_name = 'sleep_sessions' 
AND column_name = 'video_played';
```

### ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´:
Ð•ÑÐ»Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÑŽÑ‚ÑÑ, Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ localStorage ÐºÐ°Ðº Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ:
```javascript
// Ð’ TamagotchiPage.tsx Ð·Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð»Ð¾Ð³Ð¸ÐºÑƒ Ð½Ð°:
const [hasPlayedSleepVideo, setHasPlayedSleepVideo] = useState(() => {
  const sessionId = data?.currentSleepSession?.id
  if (sessionId) {
    return localStorage.getItem(`sleep_video_played_${sessionId}`) === 'true'
  }
  return false
})
```
