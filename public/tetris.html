<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover, maximum-scale=1.0">
    <title>Судоку Тетрис</title>
    
    <!-- PWA Meta Tags -->
    <meta name="application-name" content="Судоку Тетрис">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Тетрис">
    <meta name="description" content="Мобильная игра Судоку Тетрис для релакса">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-config" content="public/browserconfig.xml">
    <meta name="msapplication-TileColor" content="#4a90e2">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="theme-color" content="#4a90e2">
    
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="game-container">
        <!-- Хедер с логотипом, счетом и комбо -->
        <header class="game-header">
            <div class="header-content">
                <div class="game-logo">Важное дело</div>
                <img src="/new.png" id="newGameBtn" class="game-control-btn" style="width: 40px; height: 40px; margin-left: 8px; cursor: pointer;" title="Новая игра" alt="Новая игра">
                <img src="/update.png" id="undoBtn" class="game-control-btn" style="width: 40px; height: 40px; margin-left: 8px; cursor: pointer;" title="Отменить ход" alt="Отменить ход">
                <img src="/mix.png" id="refreshBtn" class="game-control-btn" style="width: 40px; height: 40px; margin-left: 8px; cursor: pointer;" title="Обновить" alt="Обновить">
                <div class="score-section">
                    <div class="current-score" id="currentScore">0</div>
                    <div class="combo-indicator" id="comboIndicator" style="display: none;">
                        <span class="combo-text">x2</span>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Основная игровая область -->
        <main class="game-main">
            <!-- Поле 9×9 -->
            <section class="game-board-section">
                <div class="game-board">
                    <canvas id="gameCanvas"></canvas>
                </div>
            </section>
            
            <!-- Лоток фигур -->
            <section class="pieces-tray">
                <div class="pieces-container" id="piecesContainer">
                    <!-- Слоты для фигур -->
                    <div id="slot1" data-slot="1">
                        <!-- Фигура будет добавлена динамически -->
                    </div>
                    <div id="slot2" data-slot="2">
                        <!-- Фигура будет добавлена динамически -->
                    </div>
                    <div id="slot3" data-slot="3">
                        <!-- Фигура будет добавлена динамически -->
                    </div>
                </div>
            </section>
            
            
        </main>
        
        <!-- Модальное окно окончания игры -->
        <div class="game-over" id="gameOver" style="display: none;">
            <!-- Контент генерируется динамически в JavaScript -->
        </div>
    </div>
    
    <script src="/main.js"></script>
    <script>
        // Добавляем обработчики для кнопок навигации
        document.addEventListener('DOMContentLoaded', function() {
            // Обработчик для кнопки "Новая игра"
            const newGameBtn = document.getElementById('newGameBtn');
            if (newGameBtn) {
                newGameBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Вызываем функцию перезапуска игры
                    if (window.game && window.game.restart) {
                        window.game.restart();
                    }
                });
            }
            
            // Обработчик для кнопки "Отменить ход"
            const undoBtn = document.getElementById('undoBtn');
            if (undoBtn) {
                undoBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (window.game && window.game.undoMove) {
                        window.game.undoMove();
                    }
                });
            }
            
            // Обработчик для кнопки "Обновить"
            const refreshBtn = document.getElementById('refreshBtn');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (window.game && window.game.refreshPieces) {
                        window.game.refreshPieces();
                    }
                });
            }
            
            // Обработчики для других кнопок навигации
            const navButtons = document.querySelectorAll('[data-tab]');
            navButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tab = this.dataset.tab;
                    // Отправляем событие для переключения вкладки
                    window.parent.postMessage({ type: 'NAVIGATION', tab: tab }, '*');
                });
            });
        });
    </script>
</body>
</html>
